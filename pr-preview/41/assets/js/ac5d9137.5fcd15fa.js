"use strict";(globalThis.webpackChunkthoughtgate_docs=globalThis.webpackChunkthoughtgate_docs||[]).push([[364],{4530(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>a,frontMatter:()=>l,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"how-to/troubleshoot","title":"Troubleshoot Common Issues","description":"Connection Issues","source":"@site/docs/how-to/troubleshoot.md","sourceDirName":"how-to","slug":"/how-to/troubleshoot","permalink":"/pr-preview/41/docs/how-to/troubleshoot","draft":false,"unlisted":false,"editUrl":"https://github.com/thoughtgate/thoughtgate/tree/main/website/docs/how-to/troubleshoot.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Monitor ThoughtGate","permalink":"/pr-preview/41/docs/how-to/monitor"},"next":{"title":"Configuration Reference","permalink":"/pr-preview/41/docs/reference/configuration"}}');var r=s(4848),t=s(8453);const l={sidebar_position:5},o="Troubleshoot Common Issues",c={},h=[{value:"Connection Issues",id:"connection-issues",level:2},{value:"&quot;Connection refused&quot; to upstream",id:"connection-refused-to-upstream",level:3},{value:"Requests timeout",id:"requests-timeout",level:3},{value:"Slack Integration",id:"slack-integration",level:2},{value:"Approval messages not appearing",id:"approval-messages-not-appearing",level:3},{value:"Reactions not detected",id:"reactions-not-detected",level:3},{value:"Configuration Issues",id:"configuration-issues",level:2},{value:"&quot;Config file not found&quot;",id:"config-file-not-found",level:3},{value:"All requests denied",id:"all-requests-denied",level:3},{value:"Performance Issues",id:"performance-issues",level:2},{value:"High latency",id:"high-latency",level:3},{value:"Memory growing",id:"memory-growing",level:3},{value:"Health Check Failures",id:"health-check-failures",level:2},{value:"Liveness probe failing",id:"liveness-probe-failing",level:3},{value:"Readiness probe failing",id:"readiness-probe-failing",level:3},{value:"SEP-1686 Task Issues",id:"sep-1686-task-issues",level:2},{value:"Task not found",id:"task-not-found",level:3},{value:"Task stuck in &quot;working&quot; state",id:"task-stuck-in-working-state",level:3},{value:"Getting Help",id:"getting-help",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"troubleshoot-common-issues",children:"Troubleshoot Common Issues"})}),"\n",(0,r.jsx)(n.h2,{id:"connection-issues",children:"Connection Issues"}),"\n",(0,r.jsx)(n.h3,{id:"connection-refused-to-upstream",children:'"Connection refused" to upstream'}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," Requests fail with upstream connection errors."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Is the upstream reachable?\ncurl http://your-upstream:3000/health\n\n# Check ThoughtGate logs\ndocker logs thoughtgate 2>&1 | grep -i upstream\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Verify the ",(0,r.jsx)(n.code,{children:"url"})," in your config's ",(0,r.jsx)(n.code,{children:"sources"})," section is correct"]}),"\n",(0,r.jsx)(n.li,{children:"In Kubernetes, ensure the service DNS is resolvable"}),"\n",(0,r.jsx)(n.li,{children:"Check network policies aren't blocking traffic"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"requests-timeout",children:"Requests timeout"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," Requests hang and eventually timeout."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check upstream latency\ntime curl http://your-upstream:3000/health\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check upstream server performance"}),"\n",(0,r.jsx)(n.li,{children:"For approval requests, check Slack connectivity"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"slack-integration",children:"Slack Integration"}),"\n",(0,r.jsx)(n.h3,{id:"approval-messages-not-appearing",children:"Approval messages not appearing"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," Requests return task IDs but no Slack message appears."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Verify token is set\necho $SLACK_BOT_TOKEN | head -c 10\n\n# Check ThoughtGate logs for Slack errors\ndocker logs thoughtgate 2>&1 | grep -i slack\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Verify the bot token has required scopes: ",(0,r.jsx)(n.code,{children:"chat:write"}),", ",(0,r.jsx)(n.code,{children:"reactions:read"}),", ",(0,r.jsx)(n.code,{children:"channels:history"}),", ",(0,r.jsx)(n.code,{children:"users:read"})]}),"\n",(0,r.jsxs)(n.li,{children:["Ensure the bot is invited to the channel: ",(0,r.jsx)(n.code,{children:"/invite @YourBot"})]}),"\n",(0,r.jsxs)(n.li,{children:["Check the channel name includes ",(0,r.jsx)(n.code,{children:"#"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"reactions-not-detected",children:"Reactions not detected"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," Messages appear but \ud83d\udc4d/\ud83d\udc4e reactions are ignored."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Verify ",(0,r.jsx)(n.code,{children:"reactions:read"})," scope is granted"]}),"\n",(0,r.jsxs)(n.li,{children:["Check the bot can read channel history (",(0,r.jsx)(n.code,{children:"channels:history"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Re-add the bot to the channel"}),"\n",(0,r.jsx)(n.li,{children:"Verify the reaction is on the correct message (not a thread reply)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"configuration-issues",children:"Configuration Issues"}),"\n",(0,r.jsx)(n.h3,{id:"config-file-not-found",children:'"Config file not found"'}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," ThoughtGate fails to start with config error."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Verify THOUGHTGATE_CONFIG is set\necho $THOUGHTGATE_CONFIG\n\n# Verify file exists\nls -la $THOUGHTGATE_CONFIG\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set the ",(0,r.jsx)(n.code,{children:"THOUGHTGATE_CONFIG"})," environment variable"]}),"\n",(0,r.jsx)(n.li,{children:"Ensure the file path is absolute or relative to working directory"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"all-requests-denied",children:"All requests denied"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"}),' Every request returns "denied" or policy error.']}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Validate YAML syntax\ncat $THOUGHTGATE_CONFIG | python -c "import sys, yaml; yaml.safe_load(sys.stdin)"\n\n# Check ThoughtGate logs\ndocker logs thoughtgate 2>&1 | grep -i policy\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensure you have ",(0,r.jsx)(n.code,{children:"governance.defaults.action: forward"})," if you want default allow"]}),"\n",(0,r.jsx)(n.li,{children:"Check for YAML syntax errors"}),"\n",(0,r.jsx)(n.li,{children:"Verify glob patterns in rules match your tool names"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"performance-issues",children:"Performance Issues"}),"\n",(0,r.jsx)(n.h3,{id:"high-latency",children:"High latency"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," Proxy adds significant latency."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Measure overhead\ntime curl -X POST http://localhost:7467 -d \'{"jsonrpc":"2.0","method":"tools/list","id":1}\'\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check if upstream is slow"}),"\n",(0,r.jsx)(n.li,{children:"Ensure adequate CPU resources"}),"\n",(0,r.jsx)(n.li,{children:"Review if complex Cedar policies are enabled"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"memory-growing",children:"Memory growing"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," Memory usage increases over time."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Monitor memory\ndocker stats thoughtgate\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check for stale pending tasks (they timeout automatically)"}),"\n",(0,r.jsx)(n.li,{children:"Report if consistently growing (may be a bug)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"health-check-failures",children:"Health Check Failures"}),"\n",(0,r.jsx)(n.h3,{id:"liveness-probe-failing",children:"Liveness probe failing"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," Kubernetes keeps restarting the pod."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:7469/health\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Increase ",(0,r.jsx)(n.code,{children:"initialDelaySeconds"})]}),"\n",(0,r.jsx)(n.li,{children:"Check if the process is actually crashing (logs)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"readiness-probe-failing",children:"Readiness probe failing"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," Pod not receiving traffic."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:7469/ready\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Verify upstream is reachable"}),"\n",(0,r.jsx)(n.li,{children:"Check config file is loaded correctly"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"sep-1686-task-issues",children:"SEP-1686 Task Issues"}),"\n",(0,r.jsx)(n.h3,{id:"task-not-found",children:"Task not found"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," ",(0,r.jsx)(n.code,{children:"tasks/get"}),' returns "task not found" error.']}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Verify the task ID format starts with ",(0,r.jsx)(n.code,{children:"tg_"})]}),"\n",(0,r.jsx)(n.li,{children:"Check if the task has expired"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Tasks expire after the configured timeout (default 5 minutes)"}),"\n",(0,r.jsx)(n.li,{children:"In-memory state is lost on pod restart (v0.2 limitation)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"task-stuck-in-working-state",children:'Task stuck in "working" state'}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptom:"})," Task never transitions to completed/failed."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Verify Slack message was posted"}),"\n",(0,r.jsx)(n.li,{children:"Check if reactions are being detected"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensure ",(0,r.jsx)(n.code,{children:"channels:history"})," scope is granted"]}),"\n",(0,r.jsx)(n.li,{children:"Check Slack polling is working (see logs)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"getting-help",children:"Getting Help"}),"\n",(0,r.jsx)(n.p,{children:"If you're still stuck:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Check the ",(0,r.jsx)(n.a,{href:"https://github.com/thoughtgate/thoughtgate/issues",children:"GitHub Issues"})]}),"\n",(0,r.jsxs)(n.li,{children:["Open a new issue with:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ThoughtGate version"}),"\n",(0,r.jsx)(n.li,{children:"Configuration (redact secrets)"}),"\n",(0,r.jsx)(n.li,{children:"Relevant logs"}),"\n",(0,r.jsx)(n.li,{children:"Steps to reproduce"}),"\n"]}),"\n"]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);