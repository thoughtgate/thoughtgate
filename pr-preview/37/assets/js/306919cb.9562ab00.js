"use strict";(globalThis.webpackChunkthoughtgate_docs=globalThis.webpackChunkthoughtgate_docs||[]).push([[360],{8453(e,n,r){r.d(n,{R:()=>d,x:()=>l});var i=r(6540);const t={},s=i.createContext(t);function d(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),i.createElement(s.Provider,{value:n},e.children)}},9093(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"reference/configuration","title":"Configuration Reference","description":"ThoughtGate is configured via a YAML configuration file and environment variables.","source":"@site/docs/reference/configuration.md","sourceDirName":"reference","slug":"/reference/configuration","permalink":"/pr-preview/37/docs/reference/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/thoughtgate/thoughtgate/tree/main/website/docs/reference/configuration.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Troubleshoot Common Issues","permalink":"/pr-preview/37/docs/how-to/troubleshoot"},"next":{"title":"Policy Syntax Reference","permalink":"/pr-preview/37/docs/reference/policy-syntax"}}');var t=r(4848),s=r(8453);const d={sidebar_position:1},l="Configuration Reference",c={},o=[{value:"Configuration File",id:"configuration-file",level:2},{value:"Minimal Configuration",id:"minimal-configuration",level:3},{value:"Full Configuration",id:"full-configuration",level:3},{value:"Environment Variables",id:"environment-variables",level:2},{value:"Port Model",id:"port-model",level:2},{value:"Governance Actions",id:"governance-actions",level:2},{value:"Rule Matching",id:"rule-matching",level:2},{value:"Exposure Configuration",id:"exposure-configuration",level:2},{value:"Admin Endpoints",id:"admin-endpoints",level:2},{value:"Prometheus Metrics",id:"prometheus-metrics",level:2},{value:"Example Configurations",id:"example-configurations",level:2},{value:"Passthrough Mode (Logging Only)",id:"passthrough-mode-logging-only",level:3},{value:"Strict Mode (Approve Everything)",id:"strict-mode-approve-everything",level:3},{value:"Production Mode (Tiered)",id:"production-mode-tiered",level:3}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"configuration-reference",children:"Configuration Reference"})}),"\n",(0,t.jsx)(n.p,{children:"ThoughtGate is configured via a YAML configuration file and environment variables."}),"\n",(0,t.jsx)(n.h2,{id:"configuration-file",children:"Configuration File"}),"\n",(0,t.jsxs)(n.p,{children:["Set the path via ",(0,t.jsx)(n.code,{children:"THOUGHTGATE_CONFIG"})," environment variable:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"export THOUGHTGATE_CONFIG=/etc/thoughtgate/config.yaml\n"})}),"\n",(0,t.jsx)(n.h3,{id:"minimal-configuration",children:"Minimal Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"schema: 1\n\nsources:\n  - id: upstream\n    kind: mcp\n    url: http://mcp-server:3000\n\ngovernance:\n  defaults:\n    action: forward\n"})}),"\n",(0,t.jsx)(n.h3,{id:"full-configuration",children:"Full Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'schema: 1\n\nsources:\n  - id: upstream\n    kind: mcp\n    url: http://mcp-server:3000\n    prefix: null  # Optional prefix for tool names\n    expose:\n      mode: all   # all | allowlist | blocklist\n\ngovernance:\n  defaults:\n    action: forward  # forward | approve | deny | policy\n  rules:\n    - match: "delete_*"\n      action: approve\n      approval: slack-ops  # References approval section\n    - match: "admin_*"\n      action: deny\n    - match: "sensitive_*"\n      action: policy\n      policy_id: sensitive-tools  # References Cedar policy\n\napproval:\n  slack-ops:\n    adapter: slack\n    channel: "#approvals"\n    timeout: 5m\n\ncedar:\n  policy_path: /etc/thoughtgate/policies.cedar\n'})}),"\n",(0,t.jsx)(n.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Variable"}),(0,t.jsx)(n.th,{children:"Required"}),(0,t.jsx)(n.th,{children:"Default"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"THOUGHTGATE_CONFIG"})}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"\u2014"}),(0,t.jsx)(n.td,{children:"Path to YAML configuration file"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"THOUGHTGATE_OUTBOUND_PORT"})}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"7467"})}),(0,t.jsx)(n.td,{children:"Port for proxy traffic"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"THOUGHTGATE_ADMIN_PORT"})}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"7469"})}),(0,t.jsx)(n.td,{children:"Port for health/metrics endpoints"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"SLACK_BOT_TOKEN"})}),(0,t.jsx)(n.td,{children:"For approvals"}),(0,t.jsx)(n.td,{children:"\u2014"}),(0,t.jsxs)(n.td,{children:["Slack Bot OAuth token (",(0,t.jsx)(n.code,{children:"xoxb-..."}),")"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"SLACK_CHANNEL"})}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"#approvals"})}),(0,t.jsx)(n.td,{children:"Default channel for approval messages"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"port-model",children:"Port Model"}),"\n",(0,t.jsx)(n.p,{children:"ThoughtGate uses an Envoy-inspired 3-port architecture:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Port"}),(0,t.jsx)(n.th,{children:"Name"}),(0,t.jsx)(n.th,{children:"Purpose"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"7467"}),(0,t.jsx)(n.td,{children:"Outbound"}),(0,t.jsx)(n.td,{children:"Client requests \u2192 upstream (main proxy)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"7468"}),(0,t.jsx)(n.td,{children:"Inbound"}),(0,t.jsx)(n.td,{children:"Reserved for webhooks (v0.3+)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"7469"}),(0,t.jsx)(n.td,{children:"Admin"}),(0,t.jsx)(n.td,{children:"Health checks, metrics"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"governance-actions",children:"Governance Actions"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Action"}),(0,t.jsx)(n.th,{children:"Behavior"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"forward"})}),(0,t.jsx)(n.td,{children:"Send to upstream immediately"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"deny"})}),(0,t.jsx)(n.td,{children:"Return error immediately"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"approve"})}),(0,t.jsx)(n.td,{children:"Create SEP-1686 task, post to Slack, wait for approval"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"policy"})}),(0,t.jsx)(n.td,{children:"Evaluate Cedar policy, then forward/approve/deny"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"rule-matching",children:"Rule Matching"}),"\n",(0,t.jsx)(n.p,{children:"Rules are evaluated in order. First match wins."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'governance:\n  rules:\n    # Most specific rules first\n    - match: "admin_delete_*"\n      action: deny\n    # Then broader patterns\n    - match: "admin_*"\n      action: approve\n    # Catch-all last (or use defaults)\n    - match: "*"\n      action: forward\n'})}),"\n",(0,t.jsx)(n.p,{children:"Patterns use glob syntax:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"*"})," matches any characters"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"?"})," matches single character"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"[abc]"})," matches character class"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"exposure-configuration",children:"Exposure Configuration"}),"\n",(0,t.jsx)(n.p,{children:"Control which tools are visible to agents:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'sources:\n  - id: upstream\n    kind: mcp\n    url: http://mcp-server:3000\n    expose:\n      mode: allowlist\n      tools:\n        - "get_*"\n        - "list_*"\n        - "search"\n'})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Mode"}),(0,t.jsx)(n.th,{children:"Behavior"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"all"})}),(0,t.jsx)(n.td,{children:"All tools visible (default)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"allowlist"})}),(0,t.jsx)(n.td,{children:"Only listed patterns visible"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"blocklist"})}),(0,t.jsx)(n.td,{children:"All except listed patterns visible"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"admin-endpoints",children:"Admin Endpoints"}),"\n",(0,t.jsx)(n.p,{children:"Available on admin port (default 7469):"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Endpoint"}),(0,t.jsx)(n.th,{children:"Method"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/health"})}),(0,t.jsx)(n.td,{children:"GET"}),(0,t.jsx)(n.td,{children:"Liveness check (returns 200 if running)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/ready"})}),(0,t.jsx)(n.td,{children:"GET"}),(0,t.jsx)(n.td,{children:"Readiness check (returns 200 if ready for traffic)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"/metrics"})}),(0,t.jsx)(n.td,{children:"GET"}),(0,t.jsx)(n.td,{children:"Prometheus metrics"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'thoughtgate_requests_total{action="forward|approve|deny"}\nthoughtgate_request_duration_seconds{quantile="0.5|0.95|0.99"}\nthoughtgate_approval_total{result="approved|rejected|timeout"}\nthoughtgate_tasks_active\nthoughtgate_upstream_requests_total{status="success|error|timeout"}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"example-configurations",children:"Example Configurations"}),"\n",(0,t.jsx)(n.h3,{id:"passthrough-mode-logging-only",children:"Passthrough Mode (Logging Only)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"schema: 1\nsources:\n  - id: upstream\n    kind: mcp\n    url: http://mcp-server:3000\ngovernance:\n  defaults:\n    action: forward\n"})}),"\n",(0,t.jsx)(n.h3,{id:"strict-mode-approve-everything",children:"Strict Mode (Approve Everything)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'schema: 1\nsources:\n  - id: upstream\n    kind: mcp\n    url: http://mcp-server:3000\ngovernance:\n  defaults:\n    action: approve\napproval:\n  default:\n    adapter: slack\n    channel: "#all-approvals"\n    timeout: 10m\n'})}),"\n",(0,t.jsx)(n.h3,{id:"production-mode-tiered",children:"Production Mode (Tiered)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'schema: 1\nsources:\n  - id: upstream\n    kind: mcp\n    url: http://mcp-server:3000\n    expose:\n      mode: blocklist\n      tools:\n        - "internal_*"\n        - "debug_*"\ngovernance:\n  defaults:\n    action: forward\n  rules:\n    - match: "delete_*"\n      action: approve\n      approval: destructive\n    - match: "drop_*"\n      action: approve\n      approval: destructive\n    - match: "admin_*"\n      action: deny\n    - match: "transfer_*"\n      action: approve\n      approval: financial\napproval:\n  destructive:\n    adapter: slack\n    channel: "#ops-approvals"\n    timeout: 5m\n  financial:\n    adapter: slack\n    channel: "#finance-approvals"\n    timeout: 10m\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);